<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayLES Inputs</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://unpkg.com/htmx.org@1.8.0"></script>
</head>
<body>
<form id="update-form" hx-post="/updatepaydf" hx-target="#paydf-container" hx-swap="outerHTML">
    <div class="table-div" id="update-table-div">
        <table class="inputs-table">
            <tbody>
                <tr class="inputs-header">
                    <td></td>
                    <td>Current</td>
                    <td>Future</td>
                    <td>Changing Month</td>
                </tr>
                {% for var in update_vars %}
                <tr class="inputs">
                    <td><label class="modalbutton" for="modal-{{ var.modal }}">{{ var.label }}</label></td>
                    <td>{{ var.current }}</td>
                    <td>
                        {% if var.type == 'select' %}
                        <select name="{{ var.name }}_future">
                            {% for opt in var.options %}
                            <option value="{{ opt }}" {% if opt == var.future %}selected{% endif %}>{{ opt }}</option>
                            {% endfor %}
                        </select>
                        {% elif var.type == 'input' %}
                        <input type="text" name="{{ var.name }}_future" value="{{ var.future }}" />
                        {% elif var.type == 'checkbox' %}
                        <input type="checkbox" name="{{ var.name }}_future" {% if var.future %}checked{% endif %} />
                        {% endif %}
                    </td>
                    <td>
                        <select name="{{ var.name }}_future_month">
                            {% for month in col_headers[2:] %}
                            <option value="{{ month }}" {% if month == var.future_month %}selected{% endif %}>{{ month }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                {% endfor %}
                <tr><td colspan="4"><input type="checkbox" id="show_all_changeable" name="show_all_changeable" {% if show_all_changeable %}checked{% endif %} onchange="this.form.submit()"> Show all changeable rows</td></tr>
                {% if show_all_changeable %}
                    {% for row in standard_rows %}
                    <tr class="inputs">
                        <td><label class="modalbutton" for="modal-{{ row.modal }}">{{ row.header }}</label></td>
                        <td>{{ row.current }}</td>
                        <td><input type="checkbox" name="{{ row.name }}_continue" {% if row.continue %}checked{% endif %}></td>
                        <td>
                            <select name="{{ row.name }}_future_month">
                                {% for month in col_headers[2:] %}
                                <option value="{{ month }}" {% if month == row.future_month %}selected{% endif %}>{{ month }}</option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>
                    {% endfor %}
                {% endif %}
                <tr><td colspan="4"><button type="submit" id="update-les-button">Update LES</button></td></tr>
            </tbody>
        </table>
    </div>

    <div class="table-div" id="settings-table-div">
        <table class="inputs-table">
            <tbody>
                <tr class="inputs-header">
                    <td colspan="2">Settings</td>
                </tr>
                <tr>
                    <td>
                        <input type="checkbox" id="show_variables" name="show_variables" {% if show_variables %}checked{% endif %} onchange="this.form.submit()"> Show all variables
                    </td>
                    <td>
                        <label for="months_display">Months Displayed:</label>
                        <select id="months_display" name="months_display" onchange="this.form.submit()">
                            {% for i in range(2,13) %}
                            <option value="{{ i }}" {% if i == months_display %}selected{% endif %}>{{ i }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <label for="export">Export as:</label>
                        <select name="export" id="export">
                            <option value="excel">Excel</option>
                            <option value="csv">CSV</option>
                        </select>
                        <button type="submit" id="export-button">Export</button>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <label for="upload-les">Upload New LES:</label>
                        <input type="file" id="upload-les" name="upload-les" accept=".pdf">
                        <button type="submit" id="submit-new-les-button">Upload</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</form>
<script>
// Optionally add JS for dynamic UI if needed
</script>
</body>
</html>