<!-- options -->
<div id="options">
    <form hx-post="/updatepaydf" hx-target="#core" hx-swap="innerHTML">
        <table class="core" id="options-table">
            <tbody>
                <tr class="core-header">
                    <td class="core-header"></td>
                    <td class="core-header">Current</td>
                    <td class="core-header">Future</td>
                    <td class="core-header">Month</td>
                </tr>

                <!-- rank -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-basepay">Rank</label>
                    </td>
                    {% set current_rank = session['paydf'].at[session['row_headers'].index("Rank"), session['col_headers'][2]] %}
                    <td class="core">{{ current_rank }}</td>
                    <td class="core">
                        <select class="core" id="rank_future" name="rank_future">
                            {% for x in config['RANKS_SHORT'] %}
                            <option value="{{x}}" {% if x == current_rank %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td class="core">
                        {% set month_options = session.col_headers[3:] %}
                        {% set default_month = month_options[0] if month_options|length > 0 else '' %}
                        <select class="core" id="rank_future_month" name="rank_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- zip code -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-bah">Zip Code</label>
                    </td>
                    <td class="core">{{session['paydf'].at[session['row_headers'].index("Zip Code"), session['col_headers'][2]]}}</td>
                    <td class="core">
                        <input class="core" type="text" onkeypress="return /[0-9]/i.test(event.key)" maxlength="5" id="zipcode_future" name="zipcode_future" value="" />
                    </td>
                    <td class="core">
                        <select class="core" id="zipcode_future_month" name="zipcode_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- dependents -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-bah">Dependents</label>
                    </td>
                    {% set current_dependents = session['paydf'].at[session['row_headers'].index("Dependents"), session['col_headers'][2]] %}
                    <td class="core">{{ current_dependents }}</td>
                    <td class="core">
                        <input class="core" type="text" onkeypress="return /[0-9]/i.test(event.key)" maxlength="2" id="dependents_future" name="dependents_future" value="{{ current_dependents }}" />
                    </td>
                    <td class="core">
                        <select class="core" id="dependents_future_month" name="dependents_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- SGLI -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-sgli">SGLI</label>
                    </td>
                    {% set value = session['paydf'].at[session['row_headers'].index("SGLI"), session['col_headers'][2]] %}
                    <td class="core">
                        {% if value is number %}
                            {{ '${:,.2f}'.format(value|abs).replace('$-','-$') }}
                        {% else %}
                            {{ value }}
                        {% endif %}
                    </td>
                    <td class="core">
                        <select class="core" id="sgli_future" name="sgli_future">
                            {% for row in config['SGLI_RATE'].itertuples() %}
                            <option value="{{row.premium}}" {% if row.premium == value|abs %} selected {% endif %}>{{"${:,.2f}".format(row.premium)}}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td class="core">
                        <select class="core" id="sgli_future_month" name="sgli_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- roth tsp -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-tsp">Roth TSP</label>
                    </td>
                    {% set value = session['paydf'].at[session['row_headers'].index("Roth TSP"), session['col_headers'][2]] %}
                    <td class="core">
                        {% if value is number %}
                            {{ '${:,.2f}'.format(value|abs).replace('$-','-$') }}
                        {% else %}
                            {{ value }}
                        {% endif %}
                    </td>
                    <td class="core">
                        <input class="core" type="text" onkeypress="return /[0-9]/i.test(event.key)" maxlength=2 id="rothtsp_future" name="rothtsp_future" placeholder="{% if value is number %}${:,.2f}{% else %}{{ value }}{% endif %}" value="" />
                    </td>
                    <td class="core">
                        <select class="core" id="rothtsp_future_month" name="rothtsp_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- federal filing status -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-federaltaxes">Federal Filing Status</label>
                    </td>
                    {% set current_filing = session['paydf'].at[session['row_headers'].index("Federal Filing Status"), session['col_headers'][2]] %}
                    <td class="core">{{ current_filing }}</td>
                    <td class="core">
                        <select class="core" id="federal_filing_status_future" name="federal_filing_status_future">
                            {% for x in config['TAX_FILING_TYPES'] %}
                            <option value="{{x}}" {% if x == current_filing %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td class="core">
                        <select class="core" id="federal_filing_status_future_month" name="federal_filing_status_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- state filing status -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-statetaxes">State Filing Status</label>
                    </td>
                    {% set current_state_filing = session['paydf'].at[session['row_headers'].index("State Filing Status"), session['col_headers'][2]] %}
                    <td class="core">{{ current_state_filing }}</td>
                    <td class="core">
                        <select class="core" id="state_filing_status_future" name="state_filing_status_future">
                            {% for x in config['TAX_FILING_TYPES'][0:2] %}
                            <option value="{{x}}" {% if x == current_state_filing %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td class="core">
                        <select class="core" id="state_filing_status_future_month" name="state_filing_status_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <!-- tax residency state -->
                <tr class="core">
                    <td class="core">
                        <label class="modalbutton" for="modal-statetaxes">Tax Residency State</label>
                    </td>
                    {% set current_state = session['paydf'].at[session['row_headers'].index("Tax Residency State"), session['col_headers'][2]] %}
                    <td class="core">{{ current_state }}</td>
                    <td class="core">
                        <select class="core" id="state_future" name="state_future">
                            {% for x in config['STATES_SHORT'] %}
                            <option value="{{x}}" {% if x == current_state %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                    <td class="core">
                        <select class="core" id="state_future_month" name="state_future_month">
                            {% for x in month_options %}
                            <option value="{{x}}" {% if x == default_month %} selected {% endif %}>{{x}}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>

                <tr class="core"><td class="core-spacer" colspan=100%></td></tr>
                <tr class="core"><td class="core-spacer" colspan=100%></td></tr>

                <!-- update LES button -->
                <tr class="core">
                    <td class="core" colspan="4">
                        <div class="updatebuttondiv">
                            <button class="updatebutton" id="update-les-button">Update LES</button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>