{% set PAYDF_TEMPLATE = config.PAYDF_TEMPLATE %}

<div id="paydf-container">

    <table id="custom-row-button-table">
        <tbody>
            <tr class="custom-row-btn-tr">
                <td class="custom-row-btn-td"></td>
                <td class="custom-row-btn-td"></td>
            </tr>
            {% for header in row_headers %}
                {% set i = loop.index0 %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['type'] == 'V' %}
                    <tr class="custom-row-btn-tr variable-row">
                        <td class="custom-row-btn-td"></td>
                        <td class="custom-row-btn-td"></td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody id="eda-reference-body">
            {% for header in row_headers %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['type'] in ['E', 'D', 'A'] and not row_info.iloc[0]['custom'] %}
                    <tr class="custom-row-btn-tr">
                        <td class="custom-row-btn-td"></td>
                        <td class="custom-row-btn-td"></td>
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody id="custom-reference-body">
            {% set custom_idx = 0 %}
            {% for header in row_headers %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['custom'] %}
                    <tr class="custom-row-btn-tr" data-header="{{ header }}">
                        <td class="custom-row-btn-td">
                            <button class="custom-row-btn edit custom-row-edit">&#9998;</button>
                        </td>
                        <td class="custom-row-btn-td">
                            <button class="custom-row-btn remove custom-row-remove">&#10005;</button>
                        </td>
                    </tr>
                    {% set custom_idx = custom_idx + 1 %}
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody>
            {% for header in row_headers %}
            {% set i = loop.index0 %}
            {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
            {% if row_info.iloc[0]['type'] == 'C' %}
                <tr class="custom-row-btn-tr">
                    <td class="custom-row-btn-td"></td>
                    <td class="custom-row-btn-td"></td>
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>



    <table id="paydf-table" class="pos-table">
        <tbody class="pos-table-section">
            <tr class="pos-table-header">
                <td class="pos-table-header"></td>
                {% for col in col_headers[1:] %}
                    <td class="pos-table-header">{{ col }}</td>
                {% endfor %}
            </tr>

            {% for header in row_headers %}
                {% set i = loop.index0 %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['type'] == 'V' %}

                <tr class="pos-table variable-row">
                    <td class="pos-table">
                        <label class="modal-button" for="modal-{{ row_info.iloc[0]['modal'] }}">{{ header }}</label>
                    </td>

                    {% for x in range(1, paydf.shape[1]) %}
                        {% set value = paydf.at[i, col_headers[x]] %}
                        <td class="pos-table">
                            {% set dtype = row_info.iloc[0]['dtype'] %}
                            {% if header in ['Traditional TSP Rate', 'Roth TSP Rate'] %}
                                {{ '{}%'.format(value) }}
                            {% elif dtype == 'Decimal' %}
                                {{ '{:,.2f}'.format(value) }}
                            {% else %}
                                {{ value }}
                            {% endif %}
                        </td>
                    {% endfor %}

                </tr>
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody class="pos-table-section">
            {% for header in row_headers %}
                {% set i = loop.index0 %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['type'] in ['E', 'D', 'A'] and not row_info.iloc[0]['custom'] %}
                    <tr class="pos-table">
                        <td class="pos-table">
                            <label class="modal-button" for="modal-{{ row_info.iloc[0]['modal'] }}">{{ header }}</label>
                        </td>
                        {% for x in range(1, paydf.shape[1]) %}
                            {% set value = paydf.at[i, col_headers[x]] %}
                            <td class="pos-table">
                                {% if value is not none and value != '' %}
                                    {{ '${:,.2f}'.format(value).replace('$-','-$') }}
                                {% else %}
                                    $0.00
                                {% endif %}
                            </td>
                        {% endfor %}
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody id="custom-row-section" class="pos-table-section">
            {% for header in row_headers %}
                {% set i = loop.index0 %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['custom'] %}
                    <tr class="pos-table custom-row" data-header="{{ header }}">
                        <td class="pos-table">
                            {{ header }}
                        </td>
                        {% for x in range(1, paydf.shape[1]) %}
                            {% set value = paydf.at[i, col_headers[x]] %}
                            <td class="pos-table">
                                {% if value is not none and value != '' %}
                                    {{ '${:,.2f}'.format(value).replace('$-','-$') }}
                                {% else %}
                                    $0.00
                                {% endif %}
                            </td>
                        {% endfor %}
                    </tr>
                {% endif %}
            {% endfor %}
        </tbody>

        <tbody>
            {% for header in row_headers %}
                {% set i = loop.index0 %}
                {% set row_info = PAYDF_TEMPLATE[PAYDF_TEMPLATE['header'] == header] %}
                {% if row_info.iloc[0]['type'] == 'C' %}

                <tr class="pos-table">
                    <td class="pos-table">
                        <label class="modal-button" for="modal-{{ row_info.iloc[0]['modal'] }}">{{ header }}</label>
                    </td>

                    {% for x in range(1, paydf.shape[1]) %}
                        {% set value = paydf.at[i, col_headers[x]] %}
                        <td class="pos-table">
                            {% if value is not none and value != '' %}
                                {{ '${:,.2f}'.format(value).replace('$-','-$') }}
                            {% else %}
                                $0.00
                            {% endif %}
                        </td>
                    {% endfor %}
                    
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>